<div class="container-fluid">
  <!-- Page Heading -->
  <h1 class="h3 mb-2 text-gray-800">Liste des utilisateurs</h1>
  <!-- DataTales Example -->
  <div class="card shadow mb-4">
    <div class="card-body">
      <div class="table">
        <div class="dataTables_wrapper dt-bootstrap4" id="dataTable_wrapper">
          <div class="row">
            <div class="col-sm-12 col-md-6">
              <div class="dataTables_length" id="dataTable_length">
                <label>Afficher
                  <div class="row">
                    <div class="col">
                      <select aria-controls="type" class="custom-select custom-select-sm" [(ngModel)]="roleFilter" name="roleFilter" (change)="applyFilters()">
                        <option value="Tous">Par rôle</option>
                        <option value="ROLE_EMPLOYEE">Employé</option>
                        <option value="ROLE_COORDINATEUR">Coordinateur</option>
                        <option value="ROLE_CHEF">Chef de projet</option>
                        <option value="ROLE_RESPONSABLE">Responsable</option>
                      </select>
                    </div>
                    <div class="col">
                      <select aria-controls="type" class="custom-select custom-select-sm" [(ngModel)]="approvalFilter" name="approvalFilter" (change)="applyFilters()">
                        <option value="Tous">Tous</option>
                        <option value="true">Approuvé</option>
                        <option value="false">Non approuvé</option>
                      </select>
                    </div>
                  </div>
                </label>
              </div>
            </div>
            <div class="col-sm-12 col-md-6 w-25">
              <div class="dataTables_filter" id="dataTable_filter">
                <div class="input-group">
                  <input type="text" class="form-control form-control-sm" placeholder="Rechercher par nom d'utilisateur ou Cin" [(ngModel)]="nameSearch" (input)="searchByName()">
                  <div class="input-group-append">
                    <button class="btn btn-primary btn-sm" type="button" (click)="applyFilters()">Rechercher</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12">
              <table aria-describedby="dataTable_info" class="table table-bordered dataTable" id="dataTable" role="grid" style="width: 100%;">
                <thead>
                <tr role="row">
                  <th aria-controls="dataTable" class="sorting" colspan="1" rowspan="1" style="width: 61px;" tabindex="0">
                    Identifiant
                  </th>
                  <th aria-controls="dataTable" class="sorting" colspan="1" rowspan="1" style="width: 61px;" tabindex="0">
                    Nom d'utilisateur
                  </th>
                  <th aria-controls="dataTable" class="sorting" colspan="1" rowspan="1" style="width: 61px;" tabindex="0">
                    Poste
                  </th>
                  <th aria-controls="dataTable" class="sorting" colspan="1" rowspan="1" style="width: 61px;" tabindex="0">
                    Département
                  </th>
                  <th aria-controls="dataTable" class="sorting" colspan="1" rowspan="1" style="width: 20%;" tabindex="0">
                    Action
                  </th>
                </tr>
                </thead>
                <tbody>
                <ng-container *ngIf="(filteredUsers.length > 0); else noUsers">
                  <tr *ngFor="let u of filteredUsers">
                    <td>cin: {{ u.cin }}<br>nom: {{ u.nom }}<br>prenom: {{ u.prenom }}</td>
                    <td>{{ u.username }}</td>
                    <td>{{ u.poste }}</td>
                    <td>{{ u.departement }}</td>
                    <td>
                      <a (click)="OpenUpdateUser(u.id)" class="btn btn-success btn-icon-split m-1">
                          <span class="icon bg-transparent text-white-50">
                            <i class="fa fa-edit bg-transparent"></i>
                          </span>
                        <span class="text">Modifier</span>
                      </a>
                      <a (click)="deleteUser(u)" class="btn btn-danger m-1 btn-icon-split">
                          <span class="icon bg-transparent text-white-50">
                            <i class="fas bg-transparent fa-trash"></i>
                          </span>
                      </a>
                    </td>
                  </tr>
                </ng-container>
                </tbody>
              </table>
              <ng-template #noUsers>
                <p>Aucun utilisateur trouvé.</p>
              </ng-template>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
